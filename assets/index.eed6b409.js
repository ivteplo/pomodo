import{o as a,c as l,p as v,a as g,b as o,l as E,w as I,d as p,t as N,e as d,F as L,r as b,f as D,g as f,h as M,T as O,u as W,i as x}from"./vendor.e6ffa402.js";const B=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function q(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=q(r);fetch(r.href,i)}};B();var u=(e,t)=>{const q=e.__vccOpts||e;for(const[s,r]of t)q[s]=r;return q};const Y={name:"Header"},H=e=>(v("data-v-da86f244"),e=e(),g(),e),K={class:"column"},U=H(()=>o("h1",null,"Pomodo",-1)),R=[U];function P(e,t,q,s,r,i){return a(),l("header",K,R)}var V=u(Y,[["render",P],["__scopeId","data-v-da86f244"]]);const F={name:"Footer"},G=o("a",{href:"https://github.com/ivteplo/pomodo",target:"_blank",rel:"noreferrer"}," Source Code ",-1),J=[G];function Z(e,t,q,s,r,i){return a(),l("footer",null,J)}var Q=u(F,[["render",Z]]);function j(){return new Worker("/pomodo/assets/timerWorker.cb7cf1da.js",{type:"module"})}const w=e=>(e.charAt(0)==="/"&&(e=e.substring(1)),e.charAt(e.length-1)==="/"&&(e=e.slice(0,-1)),e),T=(...e)=>{var t;return(((t=e[0])==null?void 0:t.charAt(0))==="/"?"/":"")+w(e.reduce((q,s)=>(s=w(s),q+(s?"/"+s:"")),""))},$=async()=>{Notification.permission==="default"&&await Notification.requestPermission()},z=(e,t)=>{Notification.permission==="granted"&&new Notification(e,{body:t,icon:T("/pomodo/","icons/ios/256.png"),sound:"default"})},X=({isRunning:e,timeLeft:t})=>E.setItem("timer",{isRunning:e,timeLeft:t,timeStamp:Date.now()}),ee=()=>E.getItem("timer"),y=e=>(e>=10?"":"0")+e,_=(e,t)=>e.map((q,s)=>q+t[s]),te=(e,t)=>e.map((q,s)=>q-t[s]),qe=(e,t,q,s,r)=>(e-t)/(q-t)*(r-s)+s;let A=()=>{};const se={name:"CircularArc",expose:["isBeingChanged"],emits:["change"],props:{min:Number,max:Number,step:Number,value:{type:Number},inputLabel:String,showCircleOnEnd:{type:Boolean,default:!1}},data(){return{radius:45,center:[50,50],isBeingChanged:!1,_value:this.value}},beforeUnmount(){A()},computed:{normal(){return[this.radius,-this.radius]},start(){return _(this.center,[0,-this.radius])},angle(){return this._value/this.max*2*Math.PI},end(){return _(this.center,[this.normal[0]*Math.sin(this.angle),this.normal[1]*Math.cos(this.angle)])},pathD(){const e=Math.min(this.angle,Math.PI),t=_(this.center,[this.normal[0]*Math.sin(e),this.normal[1]*Math.cos(e)]);return["M",...this.start,"A",this.radius,this.radius,0,0,1,...t,"M",...t,"A",this.radius,this.radius,0,0,1,...this.end].join(" ")}},methods:{startChange(){this.isBeingChanged=!0;const e=q=>this.onChange(q),t=()=>this.endChange();window.addEventListener("mousemove",e),window.addEventListener("touchmove",e),window.addEventListener("mouseup",t),window.addEventListener("touchend",t),A=()=>{window.removeEventListener("mousemove",t),window.removeEventListener("touchmove",t),window.removeEventListener("mouseup",t),window.removeEventListener("touchend",t)}},endChange(){this.isBeingChanged=!1,this._value=this.value,A(),A=()=>{}},onChange(e){if(!this.isBeingChanged)return;const t=e.touches?e.touches[0]:e,q=this.$refs.svg,s=[t.pageX,t.pageY],r=q.getBoundingClientRect(),i=[r.left+r.width/2,r.top+r.height/2],n=te(s,i);let h=Math.atan2(-n[1],-n[0]);h>Math.PI/2&&h<=Math.PI?h-=Math.PI/2:h+=1.5*Math.PI;let c=Math.round(qe(h,0,2*Math.PI,0,this.max));c=Math.max(this.min,c),c!==this._value&&Math.abs(c-this._value)<=this.max/2&&(this._value=c,this.$emit("change",{value:c}))},onInputChange(e){const t=Math.round(Math.max(0,Math.min(this.max,e.target.value)));e.target.value=t,this._value=t,this.$emit("change",{value:t})}},watch:{"$props.value"(){this._value=this.value}}},re=e=>(v("data-v-314df09b"),e=e(),g(),e),ie={class:"CircularArc"},oe={"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",ref:"svg"},ae=re(()=>o("circle",{class:"background",cx:"50",cy:"50",r:"45"},null,-1)),ne=["d"],le=["cx","cy"],de={key:0,class:"ScreenReaderOnly"},ue={for:"input"},ce=["min","max","step","value"];function he(e,t,q,s,r,i){return a(),l("div",ie,[(a(),l("svg",oe,[ae,o("path",{d:i.pathD,fill:"transparent",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round"},null,8,ne),q.showCircleOnEnd?(a(),l("circle",{key:0,cx:i.end[0],cy:i.end[1],r:"5",onMousedown:t[0]||(t[0]=(...n)=>i.startChange&&i.startChange(...n)),onTouchstart:t[1]||(t[1]=I((...n)=>i.startChange&&i.startChange(...n),["prevent"]))},null,40,le)):p("",!0)],512)),q.showCircleOnEnd?(a(),l("div",de,[o("label",ue,N(this.inputLabel),1),o("input",{id:"input",class:"ScreenReaderOnly",type:"range",min:q.min,max:q.max,step:q.step,value:q.value,onChange:t[2]||(t[2]=(...n)=>i.onInputChange&&i.onInputChange(...n))},null,40,ce)])):p("",!0)])}var me=u(se,[["render",he],["__scopeId","data-v-314df09b"]]);const pe={class:"TimerDisplay"},fe=["title"],Ae={name:"TimerDisplay",expose:["timerDuration","timeLeft","start","stop","onTick"],emits:["timerEnd"],props:{min:{type:Number,default:10},max:{type:Number,default:120},step:{type:Number,default:5},initialDuration:{type:Number,default:25*60}},data(){return{timerDuration:this.initialDuration,timeLeft:null,hasStarted:!1}},methods:{timeString(e){const t=Math.floor(e/60),q=Math.floor(e%60);return[...y(t),":",...y(q)].join("")},onTick(e){!this.hasStarted||(this.timeLeft=Math.max(0,this.timeLeft-e/1e3),this.timeLeft===0&&(this.stop(),this.$emit("timerEnd")))},start(){this.hasStarted||(this.timeLeft=this.timerDuration,this.hasStarted=!0)},stop(){!this.hasStarted||(this.hasStarted=!1,this.timeLeft=null)},onTimerDurationChange({value:e}){this.timerDuration=Math.round(e/this.step)*this.step*60}},computed:{shownTime(){return this.hasStarted?this.timeLeft:this.timerDuration},timerValueTitle(){return this.hasStarted?"Time left":"Timer duration in minutes"}}},ve=Object.assign(Ae,{setup(e){return(t,q)=>(a(),l("div",pe,[d(me,{class:"CircularArc",min:e.min,max:e.max,step:e.step,value:+t.shownTime/60,showCircleOnEnd:!t.hasStarted,inputLabel:"Timer duration in minutes",onChange:t.onTimerDurationChange},null,8,["min","max","step","value","showCircleOnEnd","onChange"]),o("p",{class:"TimerValue row",title:t.timerValueTitle},[(a(!0),l(L,null,b(Object.entries(t.timeString(t.shownTime)),([s,r])=>(a(),l("span",{key:s},N(r),1))),128))],8,fe)]))}});var ge=u(ve,[["__scopeId","data-v-0d546b4b"]]);const _e={name:"Alert",emits:["hide"],props:{isOpen:Boolean,role:{type:String,default:"alert"}},methods:{hide(){this.$emit("hide")}}},Me={key:0,class:"Alert"},we=["role"],ye={class:"AlertContentsInformation column"},Ee={class:"AlertActionButtons column"};function Ne(e,t,q,s,r,i){return a(),D(O,{name:"fade"},{default:f(()=>[q.isOpen?(a(),l("div",Me,[o("div",{class:"AlertOverlay",onClick:t[0]||(t[0]=(...n)=>i.hide&&i.hide(...n))}),o("div",{class:"AlertContents column",role:q.role},[o("div",ye,[M(e.$slots,"body",{},void 0,!0)]),o("div",Ee,[M(e.$slots,"actions",{},void 0,!0)])],8,we)])):p("",!0)]),_:3})}var S=u(_e,[["render",Ne],["__scopeId","data-v-1ba570c5"]]),Te="data:audio/mpeg;base64,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";const C=e=>(v("data-v-4b348398"),e=e(),g(),e),Se={class:"Timer column"},Ce=["src"],ke=C(()=>o("h2",null,"Yoo!",-1)),Ie=C(()=>o("p",null,"You've finished your pomodoro! Now it's time to relax for a bit.",-1));let m;const Le={name:"Timer",expose:["startTimer","stopTimer"],data(){return{timerHasStarted:!1,timerWorker:null,elapsedFromLastSave:0,showYooModal:!1}},beforeMount(){m=new j,m.addEventListener("message",e=>{var t;switch((t=e.data)==null?void 0:t.action){case"tick":return this.onTick(e.data.deltaTime);default:console.error("Unknown timer worker message",e.data)}})},async mounted(){const e=await ee();if(!(e!=null&&e.isRunning))return;const t=e.timeLeft-(Date.now()-e.timeStamp)/1e3,{timerDuration:q}=this.$refs.timerDisplay;this.$refs.timerDisplay.timerDuration=t,this.startTimer(),setTimeout(()=>{this.$refs.timerDisplay.timerDuration=q},0)},beforeUnmount(){m.postMessage("stopTimer")},methods:{startTimer(){$(),this.timerHasStarted=!0},stopTimer(e=!1){e||(this.$refs.yooSound.play(),this.showYooModal=!0,z("Yoo!","You've finished the pomodoro! It's time to relax for a bit")),this.timerHasStarted=!1},onTick(e){this.elapsedFromLastSave+=e,this.$refs.timerDisplay.onTick(e),this.saveState()},saveState(e=!1){if(!e&&this.elapsedFromLastSave<2e3)return;const t={isRunning:this.timerHasStarted,timeLeft:this.$refs.timerDisplay.timeLeft};X(t).catch(console.error),this.elapsedFromLastSave=0},hideYooModal(){this.showYooModal=!1}},watch:{timerHasStarted(e){e?(this.$refs.timerDisplay.start(),m.postMessage("startTimer")):(this.$refs.timerDisplay.stop(),m.postMessage("stopTimer")),this.saveState(!0)}}},be=Object.assign(Le,{setup(e){return(t,q)=>(a(),l("section",Se,[o("audio",{src:W(Te),ref:"yooSound"},null,8,Ce),d(ge,{ref:"timerDisplay",onTimerEnd:t.stopTimer},null,8,["onTimerEnd"]),t.timerHasStarted?p("",!0):(a(),l("button",{key:0,type:"button",class:"primary",onClick:q[0]||(q[0]=(...s)=>t.startTimer&&t.startTimer(...s))}," Start ")),t.timerHasStarted?(a(),l("button",{key:1,type:"button",class:"gray",onClick:q[1]||(q[1]=()=>t.stopTimer(!0))}," Cancel ")):p("",!0),d(S,{isOpen:t.showYooModal,onHide:t.hideYooModal},{body:f(()=>[ke,Ie]),actions:f(()=>[o("button",{type:"button",class:"gray",onClick:q[2]||(q[2]=(...s)=>t.hideYooModal&&t.hideYooModal(...s))},"OK")]),_:1},8,["isOpen","onHide"])]))}});var De=u(be,[["__scopeId","data-v-4b348398"]]);const k=e=>(v("data-v-a76c3e32"),e=e(),g(),e),Oe={class:"App fill column"},We=k(()=>o("h2",null,"Update",-1)),xe=k(()=>o("p",null," There is an update available. It will be installed when all tabs for this page are closed. ",-1)),Be={name:"App",data(){return{isUpdateAlertShown:!1,newWorker:null}},mounted(){this.checkForUpdates()},methods:{hideUpdateAlert(){this.isUpdateAlertShown=!1},skipWaiting(){!newWorker||newWorker.postMessage({action:"skipWaiting"})},async checkForUpdates(){if(!navigator.serviceWorker)return;const e=await navigator.serviceWorker.getRegistration();e==null||e.addEventListener("updatefound",()=>{const t=e.installing;t!=null&&t.addEventListener("statechange",()=>{t.state==="installed"&&(navigator.serviceWorker.controller?(this.newWorker=t,this.isUpdateAlertShown=!0,console.log("New content is available")):console.log("Content is cached for offline use"))})}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()})}}},Ye=Object.assign(Be,{setup(e){return(t,q)=>(a(),l("div",Oe,[d(V),d(De),d(Q),d(S,{onHide:t.hideUpdateAlert,isOpen:t.isUpdateAlertShown},{body:f(()=>[We,xe]),actions:f(()=>[o("button",{type:"button",onClick:q[0]||(q[0]=(...s)=>t.skipWaiting&&t.skipWaiting(...s))},"Reload"),o("button",{type:"button",class:"gray",onClick:q[1]||(q[1]=(...s)=>t.hideUpdateAlert&&t.hideUpdateAlert(...s))}," Cancel ")]),_:1},8,["onHide","isOpen"])]))}});var He=u(Ye,[["__scopeId","data-v-a76c3e32"]]);x(He).mount("#app");function Ke(){if(!navigator.serviceWorker)return;console.log("navigator.serviceWorker is available");const e="/pomodo/",t=T(e,"serviceWorker.js"),q=e;console.log(`Registering service worker ${t} for ${q} scope`),navigator.serviceWorker.register(t,{scope:q}).then(s=>{console.log("[Service worker] Registered with the scope "+s.scope)}).catch(console.error)}Ke();
